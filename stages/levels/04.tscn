[gd_scene load_steps=14 format=3 uid="uid://bgq4ex7ydjv3q"]

[ext_resource type="Script" uid="uid://cjrcynyvca5ey" path="res://stages/levels/level.gd" id="1_8mpwy"]
[ext_resource type="Texture2D" uid="uid://cqk7uex1f0dx2" path="res://assets/backgrounds/intersection.webp" id="2_5cxev"]
[ext_resource type="PackedScene" uid="uid://coanmt2qnu7dy" path="res://entities/goal/goal.tscn" id="3_ms56d"]
[ext_resource type="PackedScene" uid="uid://urr8bagcauuh" path="res://entities/player/player.tscn" id="4_itqtj"]
[ext_resource type="PackedScene" uid="uid://be47gx5gdtrqr" path="res://entities/demerit_zone/demerit_zone.tscn" id="5_etu8o"]
[ext_resource type="PackedScene" uid="uid://b0ehc2lb0ucx7" path="res://entities/base_car/base_car.tscn" id="6_5cxev"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_3nmem"]
size = Vector2(175.9375, 141.62344)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_lmfkw"]
size = Vector2(1096, 20)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_uojxv"]
size = Vector2(1098, 20)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_nufpr"]
size = Vector2(20, 1100)

[sub_resource type="Animation" id="Animation_5cxev"]
resource_name = "Cars"
length = 3.0
step = 0.6033
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1.5),
"transitions": PackedFloat32Array(0.3186409, 0.060371112),
"update": 0,
"values": [Vector2(296, 440), Vector2(325, 439)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("../TopCar:position")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.9608296, 2.5638137),
"transitions": PackedFloat32Array(1.319508, 1.3, 1.3),
"update": 0,
"values": [Vector2(527, 89), Vector2(527, 180), Vector2(527, 809)]
}

[sub_resource type="Animation" id="Animation_ms56d"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(266, 442)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("../TopCar:position")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(527, 89)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_itqtj"]
_data = {
&"Cars": SubResource("Animation_5cxev"),
&"RESET": SubResource("Animation_ms56d")
}

[node name="04" type="Node2D"]
script = ExtResource("1_8mpwy")
test_description = "Left Turn

Make a left turn at this intersection."

[node name="Background" type="Sprite2D" parent="."]
position = Vector2(593, 360)
texture = ExtResource("2_5cxev")

[node name="Goal" parent="." node_paths=PackedStringArray("player", "collision_shape") instance=ExtResource("3_ms56d")]
position = Vector2(319, 289)
player = NodePath("../Player")
goal_speed_threshold = 50.0
collision_shape = NodePath("GoalArea")
metadata/_edit_group_ = true

[node name="GoalArea" type="CollisionShape2D" parent="Goal"]
shape = SubResource("RectangleShape2D_3nmem")

[node name="Player" parent="." instance=ExtResource("4_itqtj")]
position = Vector2(665, 641)
rotation = -1.5707964
scale = Vector2(1.1, 1.1)

[node name="DemeritZone" parent="." instance=ExtResource("5_etu8o")]
position = Vector2(0, 1)

[node name="DisallowedArea" type="CollisionPolygon2D" parent="DemeritZone"]
position = Vector2(0, -1)
polygon = PackedVector2Array(44, -151, 1141, -153, 1141, 891, 742, 891, 741, 218, 222, 217, 222, 368, 520, 368, 601, 456, 600, 721, 741, 721, 741, 891, 44, 891)

[node name="WorldBounds" type="Area2D" parent="."]

[node name="Bottom" type="CollisionShape2D" parent="WorldBounds"]
position = Vector2(592, 902)
shape = SubResource("RectangleShape2D_lmfkw")

[node name="Top" type="CollisionShape2D" parent="WorldBounds"]
position = Vector2(592, -164)
rotation = -3.1415925
shape = SubResource("RectangleShape2D_uojxv")

[node name="Left" type="CollisionShape2D" parent="WorldBounds"]
position = Vector2(32, 375)
shape = SubResource("RectangleShape2D_nufpr")

[node name="Right" type="CollisionShape2D" parent="WorldBounds"]
position = Vector2(1152, 375)
shape = SubResource("RectangleShape2D_nufpr")

[node name="Obstacles" type="Node2D" parent="."]

[node name="AnimationPlayer" type="AnimationPlayer" parent="Obstacles"]
root_node = NodePath("../LeftCar")
libraries = {
&"": SubResource("AnimationLibrary_itqtj")
}
autoplay = "Cars"

[node name="LeftCar" parent="Obstacles" instance=ExtResource("6_5cxev")]
position = Vector2(266, 442)
scale = Vector2(1, 1)
tint = Color(0.12941177, 0.19607843, 0.84313726, 1)

[node name="TopCar" parent="Obstacles" instance=ExtResource("6_5cxev")]
position = Vector2(527, 89)
rotation = 1.5707964
scale = Vector2(1, 1)
tint = Color(0.6039216, 0.6, 0.80784315, 1)

[connection signal="parked" from="Goal" to="." method="_on_parked"]
[connection signal="player_dead" from="Player" to="." method="_on_player_player_dead"]
[connection signal="area_entered" from="DemeritZone" to="." method="_on_demerit_zone_area_entered"]
[connection signal="area_exited" from="DemeritZone" to="." method="_on_demerit_zone_area_exited"]
[connection signal="demerit" from="DemeritZone" to="." method="_on_demerit_zone_demerit"]
